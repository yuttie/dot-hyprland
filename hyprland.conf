# This is an example Hyprland config file.
# Refer to the wiki for more information.
# https://wiki.hyprland.org/Configuring/Configuring-Hyprland/

# Please note not all available settings / options are set here.
# For a full list, see the wiki

# You can split this configuration into multiple files
# Create your files separately and then link them to this file like this:
# source = ~/.config/hypr/myColors.conf


################
### MONITORS ###
################

# See https://wiki.hyprland.org/Configuring/Monitors/
monitor = , preferred, auto, 1


###################
### MY PROGRAMS ###
###################

# See https://wiki.hyprland.org/Configuring/Keywords/

# Set programs that you use
$terminal   = ~/.local/bin/term start --always-new-process
$editor     = ~/.local/bin/term start --always-new-process -- nvim
$webbrowser = ~/.local/bin/google-chrome-stable
$menu       = rofi -no-case-sensitive -matching regex -sort -sorting-method fzf -modi drun##run -show drun -show-icons -drun-show-actions


#################
### AUTOSTART ###
#################

# Wallpaper
exec-once = hyprpaper

# Update environment variables
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP=Hyprland

# Check clamshell mode
exec = $HOME/.config/sway/check_clamshell_mode.sh

# Autostart
exec-once = xrdb -load ~/.Xresources
exec-once = pasystray
exec-once = nm-applet --indicator
exec-once = blueman-applet
exec-once = dropbox
exec-once = /usr/libexec/polkit-gnome-authentication-agent-1

exec-once = fcitx5 -dr
exec-once = waybar
exec = killall swayidle; swayidle -w

# Settings for Gnome apps
$gnome-schema = org.gnome.desktop.interface
exec = gsettings set $gnome-schema gtk-theme 'Materia-light-compact'
exec = gsettings set $gnome-schema icon-theme 'Papirus-Light'
exec = gsettings set $gnome-schema cursor-size '32'
exec = gsettings set $gnome-schema cursor-theme 'Breeze'
exec = gsettings set $gnome-schema font-name 'sans-serif 10'
exec = gsettings set $gnome-schema gtk-key-theme 'Emacs'


#############################
### ENVIRONMENT VARIABLES ###
#############################

# See https://wiki.hyprland.org/Configuring/Environment-variables/

env = XCURSOR_THEME, Breeze
env = XCURSOR_SIZE, 32
env = HYPRCURSOR_SIZE, 32

env = XDG_SESSION_TYPE,wayland
env = XDG_CURRENT_DESKTOP,Hyprland
env = XDG_CURRENT_SESSION,Hyprland
env = XDG_SESSION_DESKTOP,Hyprland
env = LIBSEAT_BACKEND,logind
env = GDK_BACKEND,wayland,x11,*
env = QT_QPA_PLATFORM,wayland;xcb
env = SDL_VIDEODRIVER,wayland
env = QT_QPA_PLATFORMTHEME,qt5ct  # Has effect also for Qt6 (no need to be qt6ct)
env = GDK_DPI_SCALE,1.5
env = QT_SCALE_FACTOR,1.5
env = MOZ_ENABLE_WAYLAND,1
env = WINIT_UNIX_BACKEND,x11
env = _JAVA_AWT_WM_NONREPARENTING,1

# Input method
env = XMODIFIERS,@im=fcitx
env = GTK_IM_MODULE,fcitx
env = QT_IM_MODULE,fcitx
env = QT5_IM_MODULE,fcitx
env = SDL_IM_MODULE,fcitx
env = GLFW_IM_MODULE,ibus

# GPU-specific
env = VDPAU_DRIVER,radeonsi
env = RADV_PERFTEST,gpl


#####################
### LOOK AND FEEL ###
#####################

# Refer to https://wiki.hyprland.org/Configuring/Variables/

# https://wiki.hyprland.org/Configuring/Variables/#general
general {
    gaps_in = 8
    gaps_out = 16

    border_size = 4

    # https://wiki.hyprland.org/Configuring/Variables/#variable-types for info about colors
    col.active_border = rgba(33ccffee) rgba(00ff99ee) 45deg
    col.inactive_border = rgba(595959aa)

    layout = dwindle
}

# https://wiki.hyprland.org/Configuring/Variables/#decoration
decoration {
    rounding = 10

    # Change transparency of focused and unfocused windows
    active_opacity = 1.0
    inactive_opacity = 1.0

    drop_shadow = true
    shadow_range = 4
    shadow_render_power = 3
    col.shadow = rgba(1a1a1aee)

    # https://wiki.hyprland.org/Configuring/Variables/#blur
    blur {
        enabled = true
        size = 4
        passes = 2
    }
}

group {
    groupbar {
        render_titles = false
    }
}

# https://wiki.hyprland.org/Configuring/Variables/#animations
animations {
    enabled = true

    # Default animations, see https://wiki.hyprland.org/Configuring/Animations/ for more

    bezier = myBezier, 0.05, 0.9, 0.1, 1.05

    animation = windows, 1, 7, myBezier
    animation = windowsOut, 1, 7, default, popin 80%
    animation = border, 1, 10, default
    animation = borderangle, 1, 8, default
    animation = fade, 1, 7, default
    animation = workspaces, 1, 6, default
}

# See https://wiki.hyprland.org/Configuring/Dwindle-Layout/ for more
dwindle {
    pseudotile = true # Master switch for pseudotiling. Enabling is bound to mainMod + P in the keybinds section below
    preserve_split = true # You probably want this
}

# See https://wiki.hyprland.org/Configuring/Master-Layout/ for more
master {
    new_status = master
}

# https://wiki.hyprland.org/Configuring/Variables/#misc
misc { 
    force_default_wallpaper = 0 # Set to 0 or 1 to disable the anime mascot wallpapers
    disable_hyprland_logo = false # If true disables the random hyprland logo / anime girl background. :(
    mouse_move_enables_dpms = false
    key_press_enables_dpms = true
}


#############
### INPUT ###
#############

# https://wiki.hyprland.org/Configuring/Variables/#input
input {
    kb_layout = jp
    kb_variant = dvorak
    kb_model =
    kb_options = ctrl:nocaps,mod:custom
    kb_rules =
    numlock_by_default = true
    repeat_delay = 300
    repeat_rate = 60

    follow_mouse = 0

    sensitivity = 0 # -1.0 - 1.0, 0 means no modification.

    touchpad {
        natural_scroll = false
    }
}

# https://wiki.hyprland.org/Configuring/Variables/#gestures
gestures {
    workspace_swipe = false
}

# Example per-device config
# See https://wiki.hyprland.org/Configuring/Keywords/#per-device-input-configs for more
device {
    name = epic-mouse-v1
    sensitivity = -0.5
}


####################
### KEYBINDINGSS ###
####################

# See https://wiki.hyprland.org/Configuring/Keywords/
$mainMod = SUPER # Sets "Windows" key as main modifier

# Launch app
bind = $mainMod, semicolon, exec, $terminal
bind = $mainMod, E, exec, $editor
bind = $mainMod, W, exec, $webbrowser
bind = $mainMod, R, exec, $menu

# Session
bind = $mainMod&Control_L, X, exec, swaylock -f -e -c 000000
bind = $mainMod&Control_L, Q, exit,

# Monitor
bind = $mainMod&Control_L, comma, focusmonitor, l
bind = $mainMod&Control_L, period, focusmonitor, r
bind = $mainMod&Control_L, Left, focusmonitor, l
bind = $mainMod&Control_L, Right, focusmonitor, r
bind = $mainMod&Control_L, Up, focusmonitor, u
bind = $mainMod&Control_L, Down, focusmonitor, d

# Workspace
bind = $mainMod, comma, workspace, m-1
bind = $mainMod, period, workspace, m+1
bind = $mainMod, V, exec, name=$(hyprctl -j workspaces | jq -r ".[].name" | rofi -no-case-sensitive -matching fuzzy -sort -sorting-method fzf -dmenu -i -p "workspace"); if [ -n "$name" ]; then hyprctl dispatch workspace "name:$name"; fi
bind = $mainMod&Shift_L, R, exec, name=$(hyprctl -j workspaces | jq -r ".[].name" | rofi -no-case-sensitive -matching fuzzy -sort -sorting-method fzf -dmenu -i -p "workspace"); if [ -n "$name" ]; then hyprctl dispatch renameworkspace $(hyprctl -j activeworkspace | jq .id) "$name"; fi
bind = $mainMod&Shift_L&Control_L, comma, movecurrentworkspacetomonitor, l
bind = $mainMod&Shift_L&Control_L, period, movecurrentworkspacetomonitor, r
bind = $mainMod&Shift_L&Control_L, Left, movecurrentworkspacetomonitor, l
bind = $mainMod&Shift_L&Control_L, Right, movecurrentworkspacetomonitor, r
bind = $mainMod&Shift_L&Control_L, Up, movecurrentworkspacetomonitor, u
bind = $mainMod&Shift_L&Control_L, Down, movecurrentworkspacetomonitor, d

# Dwindle layout
bind = $mainMod&Control_L, V, togglesplit,

# Group
bind = $mainMod, T, togglegroup,
bind = $mainMod, P, changegroupactive, b
bind = $mainMod, N, changegroupactive, f
bind = $mainMod&Shift_L, P, movegroupwindow, b
bind = $mainMod&Shift_L, N, movegroupwindow, f

# Focused window
bind = $mainMod&Control_L, C, killactive,
bind = $mainMod&Shift_L, space, togglefloating,
bind = $mainMod, F, fullscreen, 2
bind = $mainMod&Shift_L, S, pin,

# Move focus
bind = $mainMod, H, movefocus, l
bind = $mainMod, L, movefocus, r
bind = $mainMod, K, movefocus, u
bind = $mainMod, J, movefocus, d

# Move focused window
bind = $mainMod&Shift_L, H, movewindoworgroup, l
bind = $mainMod&Shift_L, L, movewindoworgroup, r
bind = $mainMod&Shift_L, K, movewindoworgroup, u
bind = $mainMod&Shift_L, J, movewindoworgroup, d
bind = $mainMod, M, exec, name=$(hyprctl -j workspaces | jq -r ".[].name" | rofi -no-case-sensitive -matching fuzzy -sort -sorting-method fzf -dmenu -i -p "workspace"); if [ -n "$name" ]; then hyprctl dispatch movetoworkspacesilent "name:$name"; fi
bind = $mainMod&Shift_L, M, exec, name=$(hyprctl -j workspaces | jq -r ".[].name" | rofi -no-case-sensitive -matching fuzzy -sort -sorting-method fzf -dmenu -i -p "workspace"); if [ -n "$name" ]; then hyprctl dispatch movetoworkspace "name:$name"; fi

# Move/resize windows with mainMod + LMB/RMB and dragging
bindm = $mainMod, mouse:272, movewindow
bindm = $mainMod, mouse:273, resizewindow
bind  = $mainMod, mouse:274, killactive,

# Screen capture
bind = ,                  Print, exec, grimshot --notify save screen - | cwebp -lossless -q 100 -m 6 -mt -o ~/Pictures/screen_$(date +%Y-%m-%d-%H%M%S).webp -- -
bind = $mainMod,          Print, exec, grimshot --notify save output - | cwebp -lossless -q 100 -m 6 -mt -o ~/Pictures/output_$(date +%Y-%m-%d-%H%M%S).webp -- -
bind = Shift_L,           Print, exec, grimshot --notify save active - | cwebp -lossless -q 100 -m 6 -mt -o ~/Pictures/active_$(date +%Y-%m-%d-%H%M%S).webp -- -
bind = Control_L&Shift_L, Print, exec, grimshot --notify save window - | cwebp -lossless -q 100 -m 6 -mt -o ~/Pictures/window_$(date +%Y-%m-%d-%H%M%S).webp -- -
bind = Control_L,         Print, exec, grimshot --notify save area   - | cwebp -lossless -q 100 -m 6 -mt -o ~/Pictures/area_$(date +%Y-%m-%d-%H%M%S).webp   -- -

# Rofi
bind = $mainMod&Shift_L, D, exec, path=$(fd --type d --type l --follow --no-ignore --owner $USER --exclude /snapshot --exclude /proc --exclude /sys --exclude /dev --exclude /mnt --exclude /tmp --base-directory / --absolute-path | rofi -no-case-sensitive -matching regex -sort -sorting-method fzf -dmenu -i -p "Open a directory"); if [ -n "$path" ]; then xdg-open "$path"; fi
bind = $mainMod&Shift_L, T, exec, path=$(fd --type d --type l --follow --no-ignore --owner $USER --exclude /snapshot --exclude /proc --exclude /sys --exclude /dev --exclude /mnt --exclude /tmp --base-directory / --absolute-path | rofi -no-case-sensitive -matching regex -sort -sorting-method fzf -dmenu -i -p "Open a terminal with a directory"); if [ -n "$path" ]; then "$HOME/.local/bin/term" start --always-new-process --cwd "$path"; fi
bind = $mainMod&Control_L, P, exec, path=$(fd --type f --type l --follow --no-ignore --extension pdf --base-directory ~/Literature | rofi -no-case-sensitive -matching regex -sort -sorting-method fzf -dmenu -i -p "Open a paper"); if [ -n "$path" ]; then xdg-open "$HOME/Literature/$path"; fi

# Mako
bind = $mainMod&Control_L, H, exec, makoctl mode | grep do-not-disturb && makoctl mode -r do-not-disturb || makoctl mode -a do-not-disturb
bind = $mainMod&Control_L, I, exec, makoctl invoke
bind = $mainMod&Control_L, A, exec, makoctl dismiss
bind = $mainMod&Control_L, R, exec, makoctl restore


##############################
### WINDOWS AND WORKSPACES ###
##############################

windowrulev2 = suppressevent maximize, class:.* # You'll probably like this.

# Make some windows floating by default
windowrulev2 = float, class:^(org.gnome.Calculator)$
windowrulev2 = float, class:^(wdisplays)$
windowrulev2 = float, class:^(nemo)$,title:( Properties)$
windowrulev2 = float, class:^(org.inkscape.Inkscape)$,title:(SVG Input)
windowrulev2 = float, class:^(Minecraft)
windowrulev2 = float, title:^(Cities: Skylines II)$

# Idle inhibit rules
windowrulev2 = idleinhibit focus, class:^(mpv)$
